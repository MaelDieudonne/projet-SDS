
```{r setup}
# Data
library(haven)
library(labelled)
library(dplyr)

# Helpers
library(stringr)

# Tables
library(gt)
library(gtsummary)
library(gtable)

# Graphs
library(ggplot2)
library(ggstats)
library(grid)
library(gridExtra)

# ACP
library(factoextra)
library(FactoMineR)
library(ggcorrplot)
```

```{r}
data1996 <- read_dta("GSS1996.dta")
data2004 <- read_dta("GSS2004.dta")
data2014 <- read_dta("GSS2014.dta")
```

# Recodages 2004

## Outcomes

Les données proviennent du module Identité Nationale, pp.96-109 du questionnaire disponible ici :
https://gss.norc.org/content/dam/gss/get-documentation/pdf/quex/2004%20GSS%20V6.pdf

Ce module a seulement été administré à 1215 personnes.

Une difficulté est que les variables retournées par haven sont mixtes : numériques pour les réponses effectives, textuelles pour les types de NAs. Or, il serait dommage d'agréger directement les NAs, car certaines correspondes à des réponses effectives, avec la modalité can't choose. Il faut plusieurs conversions successives pour bien récupérer cette dernière. On la traite comme une modalité neutre, les échelles de Likert à 4 modalités passant ainsi à 5. On en profite pour standardiser les valeurs en les centrant sur 0, ainsi que les labels. On obtient deux nouvelles variables : l'une numérique correspondant à un score, l'autre factorielle.

Q.2 - How close do you feel to... 
a. Your town or city
b. Your state
c. America
d. North America

B&M retiennent n'utilisent pas les items a (clsetown), b (clsestat) et d (clsenoam).

```{r}
# Variables
close_vars <- c('clseusa')
# close_vars <- c('clsetown', 'clsestat', 'clseusa', 'clsenoam') # with all items
close_vars_n <- paste0(close_vars, "_n")

# Labels
# close_lbls <- c('Not close at all', 'Not very close', 'Can\'t choose', 'Close', 'Very close') # original
close_lbls <- c('Not at all', 'Not very much', 'Can\'t choose', 'Somewhat / fairly', 'Very much') # standardized

data2004 <- data2004 %>%
  mutate(across(all_of(close_vars), 
                ~ as_factor(.)
                )) %>%
  mutate(across(all_of(close_vars), 
                ~ case_when(
                  . == 'VERY CLOSE' ~ 2,
                  . == 'close' ~ 1,
                  . == 'CANT CHOOSE' ~ 0,
                  . == 'NOT VERY CLOSE' ~ -1,
                  . == 'NOT CLOSE AT ALL' ~ -2,
                  TRUE ~ NA_real_),
                .names = '{.col}_n')) %>%
  mutate(across(all_of(close_vars_n), 
                ~ factor(.,
                         levels = c(-2:2),
                         labels = close_lbls),
                .names = "{stringr::str_replace(.col, '_n$', '')}_f"))
```

Q.3 - Some people say the following things are important for being truly American. Others say they are not important. How important do you think each of the following is?
a. To have been born in America
b. To have American citisenship
c. To have lived in America for most of one's life
d. To be able to speak English
e. To be a Christian
f. To respect America's political institutions and laws
g. To feel American
h. To have American ancestry

B&M n'utilisent pas l'a modalité l'item h (amancstr).

```{r}
# Variables
imp_vars <- c('ambornin', 'amcit', 'amlived', 'amenglsh', 'amchrstn', 'amgovt', 'amfeel')
# imp_vars <- c(imp_vars, 'amancstr') # with all items
imp_vars_n <- paste0(imp_vars, "_n")

# Labels
# imp_lbls <- c('Not important at all', 'Not very important', 'Can\'t choose', 'Fairly important', 'Very important') # originals
imp_lbls <- c('Not at all', 'Not very much', 'Can\'t choose', 'Somewhat / fairly', 'Very much') # standardized

data2004 <- data2004 %>%
  mutate(across(all_of(imp_vars), 
                ~ as_factor(.)
                )) %>%
  mutate(across(all_of(imp_vars), 
                ~ case_when(
                  . == 'VERY IMPORTANT' ~ 2,
                  . == 'FAIRLY IMPORTANT' ~ 1,
                  . == 'NOT VERY IMPORTANT' ~ -1,
                  . == 'NOT IMPORTANT AT ALL' ~ -2,
                  . == 'CANT CHOOSE' ~ 0,
                  TRUE ~ NA_real_),
                .names = '{.col}_n')) %>%
  mutate(across(all_of(imp_vars_n), 
                ~ factor(.,
                         levels = c(-2:2),
                         labels = imp_lbls),
                .names = "{stringr::str_replace(.col, '_n$', '')}_f"))
```

Q.4 / How much do you agree or disagree with the following statements?
a. I would rather be a citizen of America than of any other country in the world
b. There are some things about America today that make me feel ashamed of America
c. The world would be a better place if people from other countries were more like the Americans
d. Generally speaking, America is a better country than most other countries
e. People should support their country even if the country is in the wrong.
f. When my country does well in international sports, it makes me proud to be American
g. I am often less proud of America than I would like to be

B&M n'utilisent pas les items f (amsports) et g (lessprd).

```{r}
# Variables
agree_vars <- c('amcitizn', 'amshamed', 'belikeus', 'ambetter', 'ifwrong') 
# agree_vars <- c(agree_vars, 'amsports', 'lessprd') # with all items
agree_vars_n <- paste0(agree_vars, "_n")

# Labels
# agree_lbls <- c('Strongly disagree', 'Disagree', 'Neither agree nor disagree', 'Agree', 'Strongly agree') # original
agree_lbls <- c('Not at all', 'Not very much', 'Can\'t choose', 'Somewhat / fairly', 'Very much') # standardized

data2004 <- data2004 %>%
  mutate(across(all_of(agree_vars), 
                ~ as_factor(.)
                )) %>%
  mutate(across(all_of(agree_vars), 
                ~ case_when(
                  . == 'STRONGLY AGREE' ~ 2,
                  . == 'agree' ~ 1,
                  . == 'NEITHER AGREE NOR DISAGREE' ~ 0,
                  . == 'disagree' ~ -1,
                  . == 'STRONGLY DISAGREE' ~ -2,
                  . == 'CANT CHOOSE' ~ 0,
                  TRUE ~ NA_real_),
                .names = '{.col}_n')) %>%
  mutate(across(all_of(agree_vars_n), 
                ~ factor(.,
                         levels = c(-2:2),
                         labels = agree_lbls),
                .names = "{stringr::str_replace(.col, '_n$', '')}_f"))
```

Q.5 / How proud are you of America in each of the following?
a. The way democracy works
b. Its political influence in the world
c. America's economic achievements
d. Its social security system
e. Its scientific and technological achievements
f. Its achievements in sports
g. Its achievements in the arts & literature
h. America's armed forces'
i. Its history
j. Its fair and equal treatment of all groups in society

B&M utilisent tous les items.

```{r}
# Variables
proud_vars = c('proudsss', 'proudgrp', 'proudpol', 'prouddem', 'proudeco', 'proudspt', 'proudart', 'proudhis', 'proudmil', 'proudsci')
proud_vars_n <- paste0(proud_vars, "_n")

# Labels
# proud_lbls <- c('Not proud at all', 'Not very proud', 'Can\'t choose', 'Somewhat proud', 'Very pround') # original
proud_lbls <- c('Not at all', 'Not very much', 'Can\'t choose', 'Somewhat / fairly', 'Very much') # standardized

data2004 <- data2004 %>%
  mutate(across(all_of(proud_vars), 
                ~ as_factor(.)
                )) %>%
  mutate(across(all_of(proud_vars), 
                ~ case_when(
                  . == 'VERY PROUD' ~ 2,
                  . == 'SOMEWHAT PROUD' ~ 1,
                  . == 'NOT VERY PROUD' ~ -1,
                  . == 'NOT PROUD AT ALL' ~ -2,
                  . == 'CANT CHOOSE' ~ 0,
                  TRUE ~ NA_real_),
                .names = '{.col}_n')) %>%
  mutate(across(all_of(proud_vars_n), 
                ~ factor(.,
                         levels = c(-2:2),
                         labels = proud_lbls),
                .names = "{stringr::str_replace(.col, '_n$', '')}_f"))
```

```{r eval=FALSE}
# Consistency checks
# Q2
sum(as_factor(data2004$clseusa) == 'CANT CHOOSE')
sum(data2004$clseusa_f == 'Can\'t choose', na.rm = TRUE)
sum(data2004$clseusa_n == 0, na.rm = TRUE)

sum(as_factor(data2004$clseusa) %in% c('iap', 'na'))
sum(is.na(data2004$clseusa_f))
sum(is.na(data2004$clseusa_n))

# Q3
sum(as_factor(data2004$ifwrong) %in% c('CANT CHOOSE', 'NEITHER AGREE NOR DISAGREE'))
sum(data2004$ifwrong_f == 'Can\'t choose', na.rm = TRUE)
sum(data2004$ifwrong_n == 0, na.rm = TRUE)

sum(as_factor(data2004$ifwrong) %in% c('iap', 'na'))
sum(is.na(data2004$ifwrong_f))
sum(is.na(data2004$ifwrong_n))

# Q4
sum(as_factor(data2004$ambornin) == 'CANT CHOOSE')
sum(data2004$ambornin_f == 'Can\'t choose', na.rm = TRUE)
sum(data2004$ambornin_n == 0, na.rm = TRUE)

sum(as_factor(data2004$ambornin) %in% c('iap', 'na'))
sum(is.na(data2004$ambornin_f))
sum(is.na(data2004$ambornin_n))

# Q5
sum(as_factor(data2004$prouddem) == 'CANT CHOOSE')
sum(data2004$prouddem_f == 'Can\'t choose', na.rm = TRUE)
sum(data2004$prouddem_n == 0, na.rm = TRUE)

sum(as_factor(data2004$prouddem) %in% c('iap', 'na'))
sum(is.na(data2004$prouddem_f))
sum(is.na(data2004$prouddem_n))
```

```{r}
data2004 <- data2004 %>%
  set_variable_labels(
    clseusa_n = 'How close ... America',
    prouddem_n = 'How proud ... the way democracy works',
    proudpol_n = 'How proud ... its political influence in the world',
    proudeco_n = 'How proud ... America\'s economic achievements',
    proudsss_n = 'How proud ... its social security system',
    proudsci_n = 'How proud ... its scientific and technological achievements',
    proudspt_n = 'How proud ... its achievements in sports',
    proudart_n = 'How proud ... its achievements in the arts & literature',
    proudmil_n = 'How proud ... America\'s armed forces',
    proudhis_n = 'How proud ... its history',
    proudgrp_n = 'How proud ... its fair and equal treatment of all groups in society',
    ambornin_n = 'How important ... to have been born in America',
    amcit_n = 'How important ... to have American citizenship',
    amlived_n = 'How important ... to have lived in America for most of one\'s life',
    amenglsh_n = 'How important ... to be able to speak English',
    amchrstn_n = 'How important ... to be a Christian',
    amgovt_n = 'How important ... to respect America\'s political institutions and laws',
    amfeel_n = 'How important ... to feel American',
    amcitizn_n = 'I would rather be a citizen of America than of any other country in the world',
    belikeus_n = 'The world would be a better place if people from other countries were more like the Americans',
    ambetter_n = 'Generally speaking, America is a better country than most other countries',
    ifwrong_n = 'People should support their country even if their country is in the wrong',
    amshamed_n = 'There are some things about America today that make me feel ashamed of America') 

data2004 <- data2004 %>%
  set_variable_labels(
    clseusa_f = 'How close ... to America',
    prouddem_f = 'How proud ... the way democracy works',
    proudpol_f = 'How proud ... its political influence in the world',
    proudeco_f = 'How proud ... America\'s economic achievements',
    proudsss_f = 'How proud ... its social security system',
    proudsci_f = 'How proud ... its scientific and technological achievements',
    proudspt_f = 'How proud ... its achievements in sports',
    proudart_f = 'How proud ... its achievements in the arts & literature',
    proudmil_f = 'How proud ... America\'s armed forces',
    proudhis_f = 'How proud ... its history',
    proudgrp_f = 'How proud ... its fair and equal treatment of all groups in society',
    ambornin_f = 'How important ... to have been born in America',
    amcit_f = 'How important ... to have American citizenship',
    amlived_f = 'How important ... to have lived in America for most of one\'s life',
    amenglsh_f = 'How important ... to be able to speak English',
    amchrstn_f = 'How important ... to be a Christian',
    amgovt_f = 'How important ... to respect America\'s political institutions and laws',
    amfeel_f = 'How important ... to feel American',
    amcitizn_f = 'I would rather be a citizen of America than of any other country in the world',
    belikeus_f = 'The world would be a better place if people from other countries were more like the Americans',
    ambetter_f = 'Generally speaking, America is a better country than most other countries',
    ifwrong_f = 'People should support their country even if their country is in the wrong',
    amshamed_f = 'There are some things about America today that make me feel ashamed of America')
```

```{r eval = FALSE}
data2004 <- data2004 %>%
  set_variable_labels(
    clsetown_n = 'How close ... your town or city',
    clsestat_n = 'How close ... your state',
    clsenoam_n = 'How close ... North America',
    amancstr_n = 'To have American ancestry',
    amsports_n = 'When my country does well in international sports, it makes me proud to be American',
    lessprd_n = 'I am often less proud of America than I would like to be')

data2004 <- data2004 %>%
  set_variable_labels(
    clsetown_f = 'How close ... your town or city',
    clsestat_f = 'How close ... your state',
    clsenoam_f = 'How close ... North America',
    amancstr_f = 'To have American ancestry',
    amsports_f = 'When my country does well in international sports, it makes me proud to be American',
    lessprd_f = 'I am often less proud of America than I would like to be')
```

## Poids de sondage

```{r}
# Weight variable
data2004 <- data2004 %>%
  mutate(wgt = as.numeric(wtssnr))
```

## Contrôles






# Résultats descriptifs

```{r}
close_vars_f <- paste0(close_vars, "_f")
imp_vars_f <- paste0(imp_vars, "_f")
agree_vars_f <- paste0(agree_vars, "_f")
proud_vars_f <- paste0(proud_vars, "_f")

all_vars = c(close_vars, imp_vars, agree_vars, proud_vars)
all_vars_n <- paste0(all_vars, "_n")
all_vars_f <- paste0(all_vars, "_f")
```

```{r}
likert_table <- 
  list(
    data2004 %>% tbl_likert(include = all_of(all_vars_f)),
    tbl_wide_summary(
      data2004|> mutate(across(all_of(all_vars_f), \(x) unclass(x))),
      statistic = c("{mean}", "{sd}", "{N_nonmiss}"),
      type = ~ "continuous",
      include = all_of(all_vars_f),
      digits = ~ 1)) %>%
  tbl_merge(tab_spanner = FALSE) %>%
  as_gt(rownames_to_stub = TRUE) %>%
  
  fmt(columns = "stat_3_2", fns = function(x) str_sub(x, 1, -3)) %>%
  
  tab_row_group(label = "How close do you feel to?", rows = which(.data$variable %in% close_vars_f), id = "close") %>%
  tab_row_group(label = "How important do you think each of the following is?", rows = which(.data$variable %in% imp_vars_f), id = "imp") %>%
  tab_row_group(label = "How much do you agree or disagree with the following statements?", rows = which(.data$variable %in% agree_vars_f), id = "agree") %>%
  tab_row_group(label = "How proud are you of America in each of the following?", rows = which(.data$variable %in% proud_vars_f), id = "proud") %>%
  row_group_order(c("close", "imp", "agree", "proud")) %>%
  
  tab_style(
    style = list(
      cell_fill(color = "lightgrey"),
      cell_text(style = "italic", weight = "bold")),
    location = cells_row_groups())  %>%
  tab_style(
    style = cell_borders(sides = "left", style = "dashed", color = "black"),
    locations = list(
      cells_column_labels(columns = "stat_1_1" | "stat_1_2" | "stat_3_2"),
      cells_body(columns = "stat_1_1" | "stat_1_2" | "stat_3_2")))

likert_table
```

```{r include=FALSE}
plot <- gglikert(data2004,
                 include = all_of(all_vars_f),
                 sort = "ascending") +
  scale_fill_brewer(palette = "RdYlBu")

ggsave("output/desc/likert_plot_2004.png", plot = plot, width = 10, height = 8, dpi = 300)
```

```{r include=FALSE}
# Creating likert plots for each question
p1 <- gglikert(data2004, include = clseusa_f, sort = "ascending", add_totals = FALSE) +
  scale_x_continuous(labels = function(x) abs(x)*100, limits = c(-0.51, 1)) + 
  scale_fill_brewer(palette = "RdYlBu") + 
  ggtitle("How close do you feel to?") +
  theme(legend.position = "none",
        plot.title = element_text(hjust = 0.5))

p2 <- gglikert(data2004, include = all_of(imp_vars_f), sort = "ascending", add_totals = FALSE) +
  scale_x_continuous(labels = function(x) abs(x)*100, limits = c(-0.51, 1)) + 
  scale_fill_brewer(palette = "RdYlBu") +
  ggtitle("How important do you think each of the following is?") +
  theme(legend.position = "none",
        plot.title = element_text(hjust = 0.5))

p3 <- gglikert(data2004, include = all_of(proud_vars_f), sort = "ascending", add_totals = FALSE) + 
  scale_fill_brewer(palette = "RdYlBu") +
  scale_x_continuous(labels = function(x) abs(x)*100, limits = c(-0.51, 1)) +
  ggtitle("How proud are you of America in each of the following?") +
  theme(legend.position = "none",
        plot.title = element_text(hjust = 0.5))

p4 <- gglikert(data2004, include = all_of(agree_vars_f), sort = "ascending", add_totals = FALSE) + 
  scale_fill_brewer(palette = "RdYlBu") +
  scale_x_continuous(labels = function(x) abs(x)*100, limits = c(-0.51, 1)) +
  ggtitle("How much do you agree or disagree with the following statements?") +
  theme(plot.title = element_text(hjust = 0.5))

# Stacking the plots while controlling for their relative height
plot <- grid.arrange(p1, p2, p3, p4, ncol = 1, heights = c(0.22, length(imp_vars_f)*0.11, length(proud_vars_f)*0.10, length(agree_vars_f)*0.13))

# Adding a title
title <- textGrob("Likert 2004", gp = gpar(fontsize = 16, fontface = "bold"))
plot <- gtable_add_rows(plot, unit(1, "cm"), pos = 0)
plot <- gtable_add_grob(plot, title, t = 1, l = 1, r = ncol(plot))

ggsave("output/desc/likert_plots_2004.png", plot = plot, width = 10, height = 15, dpi = 300)
```

# ACP

```{r}
# Fonction pour tracer les corrplots
draw_corrplot <- function(data, title, subtitle, filename, range) {
  corrplot <- ggcorrplot(
    data,
    method = "square",
    ggtheme = theme_grey,
    show.legend = TRUE,
    outline.color = "darkgrey",
    tl.cex = 8) +
    
    if (identical(range, c(-1,1))) {
      scale_fill_gradient2(limit = c(-1,1), low = "#6D9EC1", mid = "white", high =  "#E46726", midpoint = 0)}
    else if (identical(range, c(0,1))) {
      scale_fill_gradient2(limit = c(0, 1), low = "white", high =  "#E46726")}

  corrplot$theme$plot.title$hjust <- 0.5
  corrplot$theme$plot.title$size <- 12
  corrplot$theme$plot.subtitle$hjust <- 0.5
  corrplot$theme$plot.subtitle$size <- 12
  corrplot$theme$legend.key.width <- unit(0.3, "cm")
  corrplot$theme$legend.key.height <- unit(1, "null")
  corrplot$theme$legend.title <- element_blank()

  ggsave(filename, plot = corrplot)
  
  corrplot$labels$title <- title
  corrplot$labels$subtitle <- subtitle
  
  print(corrplot)
}
```

Il faut bien décider / justifier de scaler ou pas (scale.unit = TRUE / FALSE).
- Sans scaling : 2 axes, portant 26 et 13 % de l'inertie totale, dont l'opposition est essentiellement tirée par 3 variables (amchrstn, ambornin, amlived)
- Avec scaling : 2 axes, potant 26 et 11% de l'inertie totale, dont l'opposition est tirée par une quinzaine de variables (dont les précédentes, dont l'effet est en quelque sorte dilué)

```{r}
pca_data <- data2004 %>%
  select(all_of(all_vars_n)) %>%
  rename_with(~ str_remove(., "_n$")) %>% # Remove _n from variables names for cleaner outputs
  na.omit()
```

```{r}
pca_results <- PCA(pca_data, scale.unit = TRUE, ncp = 10, graph = FALSE)

# Résultats
## Histogramme de la contribution des axes à la variance totale
screeplot <- fviz_screeplot(pca_results, addlabels = TRUE, ylim = c(0, 45), title = "") + theme_gray()
screeplot$layers[[1]]$aes_params$fill <- "lightskyblue"
screeplot$layers[[1]]$aes_params$colour <- "cornflowerblue"
screeplot$layers[[2]]$aes_params$colour <- "darkblue"
screeplot$layers[[3]]$aes_params$colour <- "darkblue"
screeplot$layers[[4]]$aes_params$colour <- "darkblue"
screeplot$labels$x <- "Dimensions"
screeplot$labels$y <- "% de variance expliquée"
screeplot$labels$title = "Histogramme de l'inertie totale"
screeplot$theme$plot.title$hjust <- 0.5
screeplot
ggsave("output/acp/screeplot_ACP.png", plot = screeplot, width = 10, height = 6, units = "in", dpi = 300)

## Contribution des variables aux axes (comportements électoraux seulement)
## Correspond à la qualité de représentation des variables (= cos2) normalisée entre 1 et 100
## Présentable à l'aide d'un tableau...
coeffs <- pca_results$var$contrib
labels <- rownames(pca_results$var$contrib)
axis_df <- data.frame(labels, coeffs, row.names = NULL)
colnames(axis_df) <- c("Variables", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10")
axis_tbl <- axis_df %>%
  gt() %>%
  fmt_number(decimals = 2, drop_trailing_zeros = TRUE) %>%
  tab_header("Contribution des variables à l'inertie des axes", subtitle = NULL, preheader = NULL) %>%
  tab_spanner(label = "Axes", columns = c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10"), id = "axes") %>%
  data_color(method = "numeric", columns = !matches("Variables"), palette ="Oranges", direction = "column") %>%
  tab_row_group(label = "How close do you feel to?", rows = which(.data$Variables %in% close_vars), id = "close") %>%
  tab_row_group(label = "How important do you think each of the following is?", rows = which(.data$Variables %in% imp_vars), id = "imp") %>%
  tab_row_group(label = "How much do you agree or disagree with the following statements?", rows = which(.data$Variables %in% agree_vars), id = "agree") %>%
  tab_row_group(label = "How proud are you of America in each of the following?", rows = which(.data$Variables %in% proud_vars), id = "proud") %>%
  row_group_order(c("close", "imp", "agree", "proud")) %>%
  tab_style(
    style = cell_text(align = "center"),
    locations = list(
      cells_column_labels(columns = c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10")),
      cells_body(columns = !matches("Variables")))) %>%
  tab_style(
    style = cell_fill(color = "lightgrey"),
    locations = cells_column_labels(columns = c("1", "3", "5", "7", "9"))) 
axis_tbl
gtsave(axis_tbl, filename = "contrib_axes_ACP.docx", path = "output/acp/")

## ... ou d'un corrplot
draw_corrplot(t(pca_results$var$contrib[, 1:10]/100), "Contribution des variables à l'inertie des axes", "", "output/acp/contrib_axes_ACP.png", range = c(0,1))

## Corrélation des variables aux axes
## Avec à nouveau deux représentations possibles...
## Des corrplots
draw_corrplot(t(pca_results$var$coord[, 1:5]), title = "Corrélation des outcomes aux axes", "", "output/acp/corr_outc_axes_ACP.png", range = c(-1,1))
# draw_corrplot(t(pca_results$quanti.sup$coord[, 1:3]), "Corrélation des régresseurs", "aux axes", "output/acp/corr_rég_axes_ACP.png", range = c(-1,1))
## Des projections sur les plans factoriels
plot.PCA(pca_results, axes = c(1,2), choix = "var", select = "cos2 7", title = "Projection sur les axes 1 et 2")
plot.PCA(pca_results, axes=c(1,3), choix="var", select = "cos2 7", title = "Projection sur les axes 1 et 3")
plot.PCA(pca_results, axes=c(2,3), choix="var", select = "cos2 7", title = "Projection sur les axes 2 et 3")

## Qualité de représentation des variables
draw_corrplot(t(pca_results$var$cos2[, 1:5]), "Qualité de représentation", "des outcomes", "output/acp/qual_rep_outc_ACP.png", range = c(0,1))
# draw_corrplot(t(pca_results$quanti.sup$cos2[, 1:3]), "Qualité de représentation", "des régresseurs", "output/acp/qual_rep_régr_ACP.png", range = c(0,1))
```

